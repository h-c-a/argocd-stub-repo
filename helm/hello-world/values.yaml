# Default values for hello-world-chart
environment: development

replicaCount: 1

image:
  repository: polinux/stress-ng
  pullPolicy: IfNotPresent
  tag: "latest"

nameOverride: ""
fullnameOverride: ""

command: ["/bin/bash", "-c"]
args:
  - |
    while true; do
      cpu_workers=$((RANDOM % 4 + 1))  # Random number of CPU workers (1-4)
      io_workers=$((RANDOM % 3 + 1))   # Random number of I/O workers (1-3)
      vm_workers=$((RANDOM % 2 + 1))   # Random number of VM workers (1-2)
      cpu_load=$((RANDOM % 100))       # Random CPU load (0-100)
      timeout=$((RANDOM % 10 + 5))     # Random timeout (5-15 seconds)
      fork_workers=$((RANDOM % 5 + 1)) # Random number of fork workers (1-5)
      vm_bytes=$((RANDOM % 512 + 128))M # Random VM memory (128M - 512M)

      # Run the stress-ng command with random parameters
      stress-ng --cpu $cpu_workers \
                --cpu-load $cpu_load \
                --io $io_workers \
                --vm $vm_workers \
                --vm-bytes $vm_bytes \
                --fork $fork_workers \
                --timeout ${timeout}s \
                --random $((RANDOM % 3 + 1)) \
                --aggressive \
                --metrics-brief

      sleep $((RANDOM % 5 + 1))  # Random sleep time between 1 to 5 seconds
    done
resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 100m
    memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80

nodeSelector: {}
tolerations: []
affinity: {}
