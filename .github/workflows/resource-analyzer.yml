name: Docker outside of Docker Test

on: [push]

jobs:
  run-container:
    runs-on: ubuntu-latest
    steps:
      - name: Print Docker info
        run: docker info

      - name: Run Docker outside of Docker
        run: |
          echo "Starting container..."
          docker run --rm \
            -v /var/run/docker.sock:/var/run/docker.sock \
            docker:latest \
            sh -c "
              # Verify Docker works inside container
              docker version
              
              # Install k3d
              apk add --no-cache curl
              curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | sh
              
              # Create k3d cluster
              k3d cluster create test-cluster --wait
              
              # Show nodes
              k3d node list
            "
